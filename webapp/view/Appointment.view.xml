<mvc:View controllerName="project1.controller.Appointment"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:f="sap.ui.layout.form">
    <Page id="appointmentPage" title="{i18n>appointmentTitle}">
        <content>
            <VBox width="100%" renderType="Bare">
                <Panel headerText="{i18n>loggedInAs}: {= ${appointments>/loggedInAdvisorId} === 'ADV001' ? 'Dr. Tan' : ${appointments>/loggedInAdvisorId} === 'ADV002' ? 'Prof. Lee' : 'Ms. Kumar' }" class="sapUiSmallMarginBottom">
                    <Text text="{i18n>advisorView}"/>
                </Panel>
                
                <f:SimpleForm editable="true" layout="ResponsiveGridLayout" title="{i18n>newAppointment}">
                    <f:content>
                        <Label text="{i18n>student}"/>
                        <Select selectedKey="{appointments>/draft/studentId}" items="{appointments>/myStudents}" change="onStudentChange">
                            <items>
                                <core:Item key="{appointments>id}" text="{appointments>name}"/>
                            </items>
                        </Select>

                        <Label text="{i18n>studentName}"/>
                        <Input value="{appointments>/draft/studentName}" placeholder="{i18n>studentNamePH}"/>

                        <Label text="{i18n>studentId}"/>
                        <Input value="{appointments>/draft/studentId}" placeholder="{i18n>studentIdPH}"/>

                        <Label text="{i18n>advisor}"/>
                        <Select selectedKey="{appointments>/draft/advisorId}" items="{appointments>/advisors}" change="onAdvisorChange">
                            <items>
                                <core:Item key="{appointments>id}" text="{appointments>name}"/>
                            </items>
                        </Select>

                        <Label text="{i18n>date}"/>
                        <DatePicker value="{appointments>/draft/date}" valueFormat="yyyy-MM-dd" displayFormat="long" change="onDateChange"/>

                        <Label text="{i18n>time}"/>
                        <Select selectedKey="{appointments>/draft/time}" items="{appointments>/timeSlots}">
                            <items>
                                <core:Item key="{appointments>}" text="{appointments>}"/>
                            </items>
                        </Select>

                        <Label text="{i18n>duration}"/>
                        <Input value="{appointments>/draft/duration}" type="Number" description="{i18n>minutes}"/>

                        <Label text="{i18n>notes}"/>
                        <TextArea value="{appointments>/draft/notes}" rows="3"/>

                        <Toolbar design="Transparent">
                            <ToolbarSpacer/>
                            <Button text="{= ${appointments>/draft/isRescheduleMode} ? 'Update Appointment' : ${i18n>create} }" type="Emphasized" press="onCreateAppointment"/>
                        </Toolbar>
                    </f:content>
                </f:SimpleForm>

                <Table id="tblAppointments" width="100%" items="{appointments>/appointments}" alternateRowColors="true">
                    <headerToolbar>
                        <Toolbar>
                            <Title text="{i18n>appointmentsList}" level="H3"/>
                            <ToolbarSpacer/>
                            <Button text="{i18n>refresh}" press="onRefresh"/>
                        </Toolbar>
                    </headerToolbar>
                    <columns>
                        <Column minScreenWidth="Tablet" demandPopin="true"><Text text="{i18n>studentName}"/></Column>
                        <Column minScreenWidth="Tablet" demandPopin="true"><Text text="{i18n>studentId}"/></Column>
                        <Column minScreenWidth="Tablet" demandPopin="true"><Text text="{i18n>advisor}"/></Column>
                        <Column minScreenWidth="Tablet" demandPopin="true"><Text text="{i18n>date}"/></Column>
                        <Column minScreenWidth="Tablet" demandPopin="true"><Text text="{i18n>time}"/></Column>
                        <Column minScreenWidth="Desktop" demandPopin="true"><Text text="{i18n>duration}"/></Column>
                        <Column minScreenWidth="Tablet" demandPopin="true" popinDisplay="Block"><Text text="{i18n>notes}"/></Column>
                        <Column width="10rem" minScreenWidth="Desktop"><Text text="{i18n>actions}"/></Column>
                    </columns>
                    <items>
                        <ColumnListItem>
                            <cells>
                                <Text text="{appointments>studentName}" wrapping="true"/>
                                <Text text="{appointments>studentId}" wrapping="true"/>
                                <Text text="{appointments>advisorName}" wrapping="true"/>
                                <Text text="{appointments>date}" wrapping="true"/>
                                <Text text="{appointments>time}" wrapping="true"/>
                                <Text text="{appointments>duration}" wrapping="true"/>
                                <Text text="{appointments>notes}" wrapping="true"/>
                                <HBox justifyContent="End" wrap="Wrap">
                                    <Button text="{i18n>reschedule}" type="Transparent" press="onRescheduleAppointment"/>
                                    <Button text="{i18n>cancel}" type="Transparent" press="onCancelAppointment"/>
                                </HBox>
                            </cells>
                        </ColumnListItem>
                    </items>
                </Table>
            </VBox>
        </content>
    </Page>
</mvc:View>
