<mvc:View controllerName="project1.controller.Appointment"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:f="sap.ui.layout.form">
    <Page id="appointmentPage" title="{i18n>appointmentTitle}">
        <content>
            <VBox width="100%" renderType="Bare">
                <!-- Logged-in Advisor Profile -->
                <Panel headerText="Advisor Profile - Logged In" class="sapUiSmallMarginBottom">
                    <VBox class="sapUiSmallMargin">
                        <HBox>
                            <Label text="Name:" class="sapUiTinyMarginEnd"/>
                            <Text text="Dr. Tan" class="sapUiTinyMarginEnd"/>
                            <Text text="(ADV001)" class="sapUiTinyMarginEnd"/>
                        </HBox>
                        <HBox>
                            <Label text="Email:" class="sapUiTinyMarginEnd"/>
                            <Text text="dr.tan@university.edu"/>
                        </HBox>
                        <HBox>
                            <Label text="Department:" class="sapUiTinyMarginEnd"/>
                            <Text text="School of Engineering"/>
                        </HBox>
                        <HBox>
                            <Label text="Specialization:" class="sapUiTinyMarginEnd"/>
                            <Text text="Software Engineering"/>
                        </HBox>
                        <HBox>
                            <Label text="Office Hours:" class="sapUiTinyMarginEnd"/>
                            <Text text="Mon-Fri 2:00 PM - 5:00 PM"/>
                        </HBox>
                        <MessageStrip text="{i18n>advisorView}" type="Information" showIcon="true" class="sapUiTinyMarginTop"/>
                    </VBox>
                </Panel>

                <!-- Create Availability Slot -->
                <f:SimpleForm editable="true" layout="ResponsiveGridLayout" title="{i18n>createSlot}">
                    <f:content>
                        <Label text="{i18n>date}"/>
                        <DatePicker value="{appointments>/slotDraft/date}" valueFormat="yyyy-MM-dd" displayFormat="long" placeholder="Select a date"/>

                        <Label text="{i18n>time}"/>
                        <Select selectedKey="{appointments>/slotDraft/time}" forceSelection="false">
                            <items>
                                <core:Item key="" text="Select"/>
                                <core:Item key="08:00" text="08:00"/>
                                <core:Item key="09:00" text="09:00"/>
                                <core:Item key="10:00" text="10:00"/>
                                <core:Item key="11:00" text="11:00"/>
                                <core:Item key="12:00" text="12:00"/>
                                <core:Item key="13:00" text="13:00"/>
                                <core:Item key="14:00" text="14:00"/>
                                <core:Item key="15:00" text="15:00"/>
                                <core:Item key="16:00" text="16:00"/>
                                <core:Item key="17:00" text="17:00"/>
                            </items>
                        </Select>

                        <Label text="{i18n>duration}"/>
                        <Input value="{appointments>/slotDraft/duration}" type="Number" description="{i18n>minutes}" maxLength="2"/>

                        <Toolbar design="Transparent">
                            <ToolbarSpacer/>
                            <Button text="{= ${appointments>/slotDraft/isEditMode} ? 'Update Slot' : 'Add Slot' }" type="Emphasized" press="onAddSlot"/>
                            <Button text="Cancel" type="Transparent" press="onCancelEdit" visible="{= ${appointments>/slotDraft/isEditMode} }" class="sapUiTinyMarginStart"/>
                        </Toolbar>
                    </f:content>
                </f:SimpleForm>

                <!-- My Availability Slots -->
                <Table id="tblMySlots" width="100%" items="{appointments>/mySlots}" alternateRowColors="true" class="sapUiSmallMarginTop">
                    <headerToolbar>
                        <Toolbar>
                            <Title text="{i18n>myAvailabilitySlots}" level="H3"/>
                        </Toolbar>
                    </headerToolbar>
                    <columns>
                        <Column minScreenWidth="Tablet" demandPopin="true"><Text text="{i18n>date}"/></Column>
                        <Column minScreenWidth="Tablet" demandPopin="true"><Text text="{i18n>time}"/></Column>
                        <Column minScreenWidth="Tablet" demandPopin="true"><Text text="{i18n>duration}"/></Column>
                        <Column minScreenWidth="Tablet" demandPopin="true"><Text text="{i18n>status}"/></Column>
                        <Column minScreenWidth="Tablet" demandPopin="true" popinDisplay="Block"><Text text="{i18n>bookedBy}"/></Column>
                        <Column width="8rem" minScreenWidth="Desktop"><Text text="{i18n>actions}"/></Column>
                    </columns>
                    <items>
                        <ColumnListItem>
                            <cells>
                                <Text text="{appointments>date}" wrapping="true"/>
                                <Text text="{appointments>time}" wrapping="true"/>
                                <Text text="{appointments>duration}" wrapping="true"/>
                                <ObjectStatus text="{appointments>status}" state="{= ${appointments>status} === 'free' ? 'Success' : 'Warning' }"/>
                                <Text text="{= ${appointments>studentName} ? ${appointments>studentName} : '-' }" wrapping="true"/>
                                <HBox justifyContent="End" wrap="Wrap">
                                    <Button text="Edit" type="Transparent" press="onEditSlot" enabled="{= ${appointments>status} === 'free' }" class="sapUiTinyMarginEnd"/>
                                    <Button text="{i18n>deleteSlot}" type="Transparent" press="onDeleteSlot" enabled="{= ${appointments>status} === 'free' }"/>
                                </HBox>
                            </cells>
                        </ColumnListItem>
                    </items>
                </Table>
            </VBox>
        </content>
    </Page>
</mvc:View>
